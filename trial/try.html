<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Zoom & Pan (Top-Left Anchored)</title>
  <style>
    canvas {
      border: 1px solid black;
      cursor: grab;
    }
    canvas:active {
      cursor: grabbing;
    }
  </style>
</head>
<body>
<canvas id="canvas" width="300px" height="300px"></canvas>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  const image = new Image();
  image.src = 'try.png'; // Replace with your image

  let scale = 1;
  let minScale = 0.1;
  let maxScale = 5;
  let originX = 0;
  let originY = 0;
  let isDragging = false;
  let dragStartX = 0;
  let dragStartY = 0;

  image.onload = () => {
    fitToTopLeft();
    draw();
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    console.log(data);
  };

  function fitToTopLeft() {
    scale = Math.min(canvas.width / image.width, canvas.height / image.height);
    originX = 0;
    originY = 0;
    
  }

  function draw() {
    ctx.setTransform(scale, 0, 0, scale, originX, originY);
    ctx.clearRect(-originX / scale, -originY / scale, canvas.width / scale, canvas.height / scale);
    ctx.drawImage(image, 0, 0);
  }

  function clampPan() {
    const maxX = 0;
    const maxY = 0;
    const minX = canvas.width - image.width * scale;
    const minY = canvas.height - image.height * scale;

    originX = Math.min(maxX, Math.max(minX, originX));
    originY = Math.min(maxY, Math.max(minY, originY));
  }

  canvas.addEventListener('wheel', (e) => {
    e.preventDefault();
    const mouseX = e.offsetX;
    const mouseY = e.offsetY;
    const scaleFactor = e.deltaY < 0 ? 1.1 : 0.9;
    const newScale = Math.min(maxScale, Math.max(minScale, scale * scaleFactor));

    // Adjust origin to zoom around cursor
    originX = mouseX - ((mouseX - originX) * (newScale / scale));
    originY = mouseY - ((mouseY - originY) * (newScale / scale));
    scale = newScale;

    clampPan();
    draw();
  });

  canvas.addEventListener('mousedown', (e) => {
    isDragging = true;
    dragStartX = e.offsetX - originX;
    dragStartY = e.offsetY - originY;
  });

  canvas.addEventListener('mousemove', (e) => {
    if (isDragging) {
      originX = e.offsetX - dragStartX;
      originY = e.offsetY - dragStartY;

      clampPan();
      draw();
    }
  });

  canvas.addEventListener('mouseup', () => isDragging = false);
  canvas.addEventListener('mouseleave', () => isDragging = false);
</script>
<script src="script.js"></script>
</body>
</html>
